<!-- Bills view -->

<div class="col-lg-12">
  <div class="clearfix">
    <h1 class="pull-left">Bills</h1>
    <div class="pull-right alert alert-success" ng-show="success">{{successmsg}}</div>
    <div class="pull-right alert alert-danger" ng-show="error">{{errormsg}}</div>
  </div>
  <hr>

	<button class="btn btn-success pull-right" data-toggle="modal" data-target="#addModal">Add Bill</button>

	<!-- Add bill modal -->
	<div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">

	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title" id="myModalLabel">Add Bill</h4>
	      </div>

	      <div class="modal-body">
			    <form class="form-horizontal" role="form">
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Name</label>
			        <div class="col-sm-6">
			          <input type="text" class="form-control" ng-model="bill.name" placeholder="Rent">
			        </div>
			      </div>
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Amount</label>
			         <div class="col-sm-6">
                <div class="input-group">
                  <span class="input-group-addon">$</span>
			            <input type="number" class="form-control" ng-model="bill.total">
                </div>
			        </div>
			      </div>
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Date</label>
			        <div class="col-sm-6">
			          <input type="date" class="form-control" ng-model="bill.date">
			        </div>
			      </div>
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Frequency</label>
			        <div class="col-sm-6">
					      <select class="form-control" ng-model="bill.interval">
					        <option value="0">One time</option>
					        <option value="2">Every week</option>
					        <option value="3">Every month</option>
					      </select>
			        </div>
			      </div>
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Responsible</label>
			        <div class="col-sm-6">
					      <ul class="list-unstyled" ng-repeat="roommate in roommates">
					        <li>
                    <input type="checkbox" value={{roommate.id}} ng-click="toggleSelection(roommate.id)"> {{roommate.first_name}} {{roommate.last_name}}
                    <div class="input-group">
                      <span class="input-group-addon">$</span>
                      <input type="number" class="form-control" placeholder="Amount" ng-model="roommate.amount">
                    </div>
                  </li>
					      </ul>
			        </div>
			      </div>
			    </form>
        </div>

	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="reset()">Cancel</button>
	        <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="addBill()">Add</button>
	      </div>

	    </div>
	  </div>
	</div>

	<!-- Bills table -->
	<div class="clearfix" id="bill-filter"><a href="" ng-click="setTable('unresolved')">Unresolved</a> | <a href="" ng-click="setTable('resolved')">Resolved</a></div>
	<table ng-show="!emptyBillList()" class="table table-striped table-hover clearfix text-center" id="bill-table">
		<tr>
			<th class="text-center">Bill</th>
			<th class="text-center">Total</th>
			<th class="text-center">Owed</th>
			<th class="text-center">Pay to</th>
			<th class="text-center">Due</th>
			<th class="text-center">Paid?</th>
			<th class="text-center">Delete</th>
		</tr>

		<tr ng-repeat="bill in bills">
			<td data-toggle="modal" data-target="#editModal" ng-click="prepareUpdate(bill.id, $index)">{{bill.name}}</td>
			<td data-toggle="modal" data-target="#editModal" ng-click="prepareUpdate(bill.id, $index)">${{bill.amount}}</td>
			<td data-toggle="modal" data-target="#editModal" ng-click="prepareUpdate(bill.id, $index)">${{amountOwed(bill.id, $index)}}</td>
			<td data-toggle="modal" data-target="#editModal" ng-click="prepareUpdate(bill.id, $index)">{{bill.payTo}}</td>
			<td data-toggle="modal" data-target="#editModal" ng-click="prepareUpdate(bill.id, $index)">{{format(bill.dueDate)}}</td>
			<td><input type="checkbox" ng-click="payBill(bill.id, $index)" ng-checked="isPaid(bill.id, $index)"></td>
			<td><i class="ion-close-circled delete-icon" ng-click="deleteBill(bill.id, $index)"></i></td>
		</tr>
	</table>

	<!-- Edit bill modal -->
	<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">

	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title" id="myModalLabel">Edit Bill</h4>
	      </div>

	      <div class="modal-body">
			    <form class="form-horizontal" role="form">
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Name</label>
			        <div class="col-sm-6">
			          <input type="text" class="form-control" ng-model="oldBill.name">
			        </div>
			      </div>
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Amount</label>
			        <div class="col-sm-6">
                <div class="input-group">
                  <span class="input-group-addon">$</span>
                  <input type="number" class="form-control" ng-model="oldBill.amount">
                </div>
			        </div>
			      </div>
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Date</label>
			        <div class="col-sm-6">
			          <input type="date" class="form-control" ng-model="oldBill.dueDate">
			        </div>
			      </div>
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Frequency</label>
			        <div class="col-sm-6">
					      <select class="form-control" ng-model="oldBill.frequency">
					        <option value="0">One time</option>
					        <option value="2">Every week</option>
					        <option value="3">Every month</option>
					      </select>
			        </div>
			      </div>
			      <div class="form-group">
			        <label class="col-sm-2 control-label">Responsible</label>
			        <div class="col-sm-6">
					      <ul class="list-unstyled" ng-repeat="roommate in roommates">
					        <li><input type="checkbox" value={{roommate.id} ng-click="toggleSelection(roommate.id)" ng-checked="isChecked(roommate.id)">{{roommate.first_name}} {{roommate.last_name}}<input type="text" placeholder="Amount" ng-model="updatedAmount[$index].amount"></li>
					      </ul>
			        </div>
			      </div>
			    </form>
	      </div>

	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="reset()">Cancel</button>
	        <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="updateBill()">Update</button>
	      </div>

	    </div>
	  </div>
	</div>

	<div class="alert alert-warning" ng-show="emptyBillList()">No bills here, add some!</div>

</div>
